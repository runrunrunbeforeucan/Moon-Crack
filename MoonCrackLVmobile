-- Загрузка UI-библиотеки
local success, Library = pcall(function()
    return loadstring(game:HttpGet("https://raw.githubusercontent.com/Robojini/Tuturial_UI_Library/main/UI_Template_1"))()
end)

if not success then
    warn("Не удалось загрузить UI-библиотеку")
    return
end

local Window = Library.CreateLib("MoonCrack ", "RJTheme1")
local Tab = Window:NewTab("MCv1.3 MOBILE")
local SectionFly = Tab:NewSection("Fly")
local SectionWalk = Tab:NewSection("Walk")
local SectionOther = Tab:NewSection("Other")

local player = game.Players.LocalPlayer

local function setup()
    local character = player.Character or player.CharacterAdded:Wait()
    local humanoidRootPart = character:WaitForChild("HumanoidRootPart")
    local humanoid = character:FindFirstChildOfClass("Humanoid")
    local UserInputService = game:GetService("UserInputService")
    local RunService = game:GetService("RunService")
    local camera = workspace.CurrentCamera

    -- ========================
    -- Полет
    local flying = false
    local flySpeed = 50
    local bodyVelocity = nil

    local function enableFly()
        if flying then return end
        flying = true
        bodyVelocity = Instance.new("BodyVelocity")
        bodyVelocity.Velocity = Vector3.new()
        bodyVelocity.MaxForce = Vector3.new(1e5, 1e5, 1e5)
        bodyVelocity.Parent = humanoidRootPart
    end

    local function disableFly()
        if not flying then return end
        flying = false
        if bodyVelocity then
            bodyVelocity:Destroy()
            bodyVelocity = nil
        end
    end

    -- Кнопка включения/выключения полета
    SectionFly:NewToggle("Fly", "Click To ON/OFF", function()
        if not flying then
            enableFly()
        else
            disableFly()
        end
    end)

    local function updateFly()
        if flying and bodyVelocity then
            local moveDirection = Vector3.new()

            if UserInputService:IsKeyDown(Enum.KeyCode.W) then
                moveDirection = moveDirection + camera.CFrame.LookVector
            end
            if UserInputService:IsKeyDown(Enum.KeyCode.S) then
                moveDirection = moveDirection - camera.CFrame.LookVector
            end
            if UserInputService:IsKeyDown(Enum.KeyCode.A) then
                moveDirection = moveDirection - camera.CFrame.RightVector
            end
            if UserInputService:IsKeyDown(Enum.KeyCode.D) then
                moveDirection = moveDirection + camera.CFrame.RightVector
            end
            if UserInputService:IsKeyDown(Enum.KeyCode.Space) then
                moveDirection = moveDirection + Vector3.new(0, 1, 0)
            end
            if UserInputService:IsKeyDown(Enum.KeyCode.LeftControl) then
                moveDirection = moveDirection - Vector3.new(0, 1, 0)
            end

            if moveDirection.Magnitude > 0 then
                moveDirection = moveDirection.Unit
            end
            bodyVelocity.Velocity = moveDirection * flySpeed
        end
    end

    RunService.RenderStepped:Connect(updateFly)

    -- Управление скоростью полета
    SectionFly:NewTextBox("Fly Speed", "Change Your Fly Speed", function(txt)
        local num = tonumber(txt)
        if num then
            flySpeed = num
        end
    end)

    -- ========================
    -- Настройка WalkSpeed
    SectionWalk:NewSlider("Walkspeed", "Slide To Change Walkspeed Max 500", 500, 0, function(s)
        if humanoid then
            humanoid.WalkSpeed = s
        end
    end)

    SectionWalk:NewButton("Restore", "Makes Speed Default", function()
        if humanoid then
            humanoid.WalkSpeed = 16
        end
    end)

    -- ========================
    -- Wall Hack / Noclip
    local wallHackEnabled = true
    local function toggleWallHack()
        wallHackEnabled = not wallHackEnabled
        for _, obj in ipairs(workspace:GetChildren()) do
            if obj.Name == "NoclipWall" and obj:IsA("BasePart") then
                obj.CanCollide = not wallHackEnabled
                obj.Transparency = wallHackEnabled and 0.5 or 0
            end
        end
        print(wallHackEnabled and "Wall hack enabled" or "Wall hack disabled")
    end

    SectionOther:NewButton("Wall Hack", "Makes Wall Noclip", function()
        toggleWallHack()
    end)

    -- Ноклип для всех частей
    SectionOther:NewToggle("All Noclip", "Disables collisions for all BaseParts", function(isOn)
        for _, obj in ipairs(workspace:GetDescendants()) do
            if obj:IsA("BasePart") then
                obj.CanCollide = not isOn
            end
        end
    end)

    -- ========================
    -- ESP для отслеживания игроков
    SectionOther:NewButton("ESP", "Click again to track new players", function()
        spawn(function()
            while true do
                wait(0.5)
                for _, child in ipairs(workspace:GetChildren()) do
                    local humanoid = child:FindFirstChildOfClass("Humanoid")
                    local hrp = child:FindFirstChild("HumanoidRootPart")
                    if humanoid and hrp and child ~= player.Character then
                        if not child:FindFirstChild("EspBox") then
                            local esp = Instance.new("BoxHandleAdornment")
                            esp.Adornee = hrp
                            esp.Size = Vector3.new(4, 5, 1)
                            esp.Transparency = 0.65
                            esp.Color3 = Color3.fromRGB(255, 48, 48)
                            esp.AlwaysOnTop = true
                            esp.ZIndex = 0
                            esp.Name = "EspBox"
                            esp.Parent = child
                        end
                    end
                end
            end
        end)
    end)

    -- Сделать игрока неуязвимым
    SectionOther:NewButton("Invincible", "Make player invincible", function()
        local character = player.Character or player.CharacterAdded:Wait()
        local humanoid = character:FindFirstChildOfClass("Humanoid")
        if humanoid then
            humanoid.MaxHealth = math.huge
            humanoid.Health = math.huge
            humanoid:SetStateEnabled(Enum.HumanoidStateType.Dead, false)
            humanoid.HealthChanged:Connect(function()
                if humanoid.Health < math.huge then
                    humanoid.Health = math.huge
                end
            end)
        end
    end)
end

if player.Character then
    setup()
else
    player.CharacterAdded:Connect(setup)
end

-- ========================
-- Управление прыжком через выпадающий список
SectionOther:NewDropdown("JUMPHACK", "jump boost", {"Normal (50)", "Enhanced (100)", "Maximum (150)"}, function(currentOption)
    local character = player.Character
    if not character then return end
    local humanoid = character:FindFirstChildOfClass("Humanoid")
    if not humanoid then return end

    local jumpSettings = {
        ["Normal (50)"] = {JumpPower = 50},
        ["Enhanced (100)"] = {JumpPower = 100},
        ["Maximum (150)"] = {JumpPower = 150}
    }

    local setting = jumpSettings[currentOption]
    if setting then
        humanoid.JumpPower = setting.JumpPower
        print("Jump power set to:", setting.JumpPower)
    end
end)
